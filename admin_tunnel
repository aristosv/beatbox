start_tunnel ()
{
 echo '[Unit]' | sudo tee -a /etc/systemd/system/tunnel.service > /dev/null
 echo 'Description=digital signage tunnel' | sudo tee -a /etc/systemd/system/tunnel.service > /dev/null
 echo 'After=network.target' | sudo tee -a /etc/systemd/system/tunnel.service > /dev/null
 echo '[Service]' | sudo tee -a /etc/systemd/system/tunnel.service > /dev/null
 echo 'ExecStart=/bin/bash -c "while true; do sshpass -p $sshpass ssh -p 22 -t -t $sshoptions user@$sshhost -R $reverseport:127.0.0.1:22; sleep 60; done"' | sudo tee -a /etc/systemd/system/tunnel.service > /dev/null
 echo 'Restart=always' | sudo tee -a /etc/systemd/system/tunnel.service > /dev/null
 echo '[Install]' | sudo tee -a /etc/systemd/system/tunnel.service > /dev/null
 echo 'WantedBy=multi-user.target' | sudo tee -a /etc/systemd/system/tunnel.service > /dev/null
 sudo systemctl daemon-reload
 sudo systemctl start tunnel.service
 sudo systemctl enable tunnel.service > /dev/null 2>&1
}

echo start tunnel ; start_tunnel
