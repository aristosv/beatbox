echo update
sudo apt-get update > /dev/null 2>&1

echo upgrade
sudo apt-get -y upgrade > /dev/null 2>&1

echo dist upgrade
sudo apt-get -y dist-upgrade > /dev/null 2>&1

echo install xinit
sudo apt-get install -y xinit > /dev/null 2>&1

echo install fim
sudo apt-get install -y fim > /dev/null 2>&1

echo install lftp
sudo apt-get install -y lftp > /dev/null 2>&1

echo install chromium
sudo apt-get install -y chromium-browser > /dev/null 2>&1

echo install omxplayer
sudo apt-get install -y omxplayer > /dev/null 2>&1

echo install python-pip
sudo apt-get install -y python-pip > /dev/null 2>&1

echo install sshpass
sudo apt-get install -y sshpass > /dev/null 2>&1

echo install youtube-dl
sudo pip install youtube-dl > /dev/null 2>&1

echo clean
sudo apt-get clean > /dev/null 2>&1

echo create folders
mkdir -p ~/media/{audio,video,images,youtube,logo}

echo hide raspberry pi icons
sudo sed -i "1 s|$| logo.nologo quiet splash|" /boot/cmdline.txt

echo hide boot messages
sudo sed -i "1 s|$| quiet splash|" /boot/cmdline.txt

echo disable login prompt
sudo systemctl disable getty@tty1.service > /dev/null 2>&1

echo hide blinking cursor
sudo sed -i "1 s|$| vt.global_cursor_default=0|" /boot/cmdline.txt

echo hide undervoltage message
sudo sed -i "1 s|$| loglevel=1|" /boot/cmdline.txt

echo hide undervoltage lightning bolt icon
sudo sed -i '1 i\avoid_warnings=1' /boot/config.txt

echo hide rainbow
sudo sed -i '1 i\disable_splash=1' /boot/config.txt

echo hide cusrsor
sudo sed -i 's/-nolisten/-nocursor -nolisten/g' /etc/X11/xinit/xserverrc

echo hush login
touch /home/pi/.hushlogin

start_logo ()
{
 echo '[Unit]' | sudo tee -a /etc/systemd/system/logo.service > /dev/null
 echo 'Description=digital signage logo' | sudo tee -a /etc/systemd/system/logo.service > /dev/null
 echo 'After=network.target' | sudo tee -a /etc/systemd/system/logo.service > /dev/null
 echo '[Service]' | sudo tee -a /etc/systemd/system/logo.service > /dev/null
 echo 'ExecStart=/usr/bin/fim -q /home/pi/media/logo/bbx.png > /dev/null 2>&1 &' | sudo tee -a /etc/systemd/system/logo.service > /dev/null
 echo 'Restart=always' | sudo tee -a /etc/systemd/system/logo.service > /dev/null
 echo '[Install]' | sudo tee -a /etc/systemd/system/logo.service > /dev/null
 echo 'WantedBy=multi-user.target' | sudo tee -a /etc/systemd/system/logo.service > /dev/null
 sudo systemctl daemon-reload
 sudo systemctl start logo.service
 sudo systemctl enable logo.service > /dev/null 2>&1
}

expand_filesystem ()
{
 sudo sed -i '$i/home/pi/startup' /etc/rc.local
 echo 'sudo raspi-config --expand-rootfs' | sudo tee -a /home/pi/startup > /dev/null
 echo 'sudo sed -i '/startup/d' /etc/rc.local' | sudo tee -a /home/pi/startup > /dev/null
 echo 'rm /home/pi/startup' | sudo tee -a /home/pi/startup > /dev/null
 echo 'sudo reboot' | sudo tee -a /home/pi/startup > /dev/null
 sudo chmod +x /home/pi/startup
}

echo start logo ; start_logo
echo expand filesystem ; expand_filesystem
